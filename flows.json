[{"id":"1602850f8ee96d62","type":"tab","label":"Log in","disabled":false,"info":"","env":[]},{"id":"6316979d28b3015d","type":"ui_text_input","z":"1602850f8ee96d62","name":"Username","label":"Username","tooltip":"","group":"a7513268b5069b0b","order":1,"width":0,"height":0,"passthru":true,"mode":"text","delay":300,"topic":"payload","sendOnBlur":false,"className":"","topicType":"msg","x":110,"y":100,"wires":[["db739ee24c301308"]]},{"id":"7710fea23e33341f","type":"ui_text_input","z":"1602850f8ee96d62","name":"Password","label":"Password","tooltip":"","group":"a7513268b5069b0b","order":2,"width":0,"height":0,"passthru":true,"mode":"password","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":100,"y":180,"wires":[["9c4e5be62b96e8ae"]]},{"id":"db739ee24c301308","type":"function","z":"1602850f8ee96d62","name":"function 18","func":"if(msg.payload !== \"\"){\n    flow.set(\"username\",msg.payload);\n\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":330,"y":100,"wires":[[]]},{"id":"9c4e5be62b96e8ae","type":"function","z":"1602850f8ee96d62","name":"function 19","func":"if(msg.payload !== \"\"){\n    flow.set(\"password\",msg.payload);\n\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":310,"y":180,"wires":[[]]},{"id":"9a9caa04953368ed","type":"ui_button","z":"1602850f8ee96d62","name":"","group":"a7513268b5069b0b","order":2,"width":0,"height":0,"passthru":false,"label":"Log in","tooltip":"","color":"","bgcolor":"green","className":"","icon":"login","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":70,"y":320,"wires":[["f91156061b48ce41"]]},{"id":"f91156061b48ce41","type":"function","z":"1602850f8ee96d62","name":"function 20","func":"\n// Retrieve username and password from flow context\nlet username = flow.get('username');\nlet password = flow.get('password');\n\n// Format them as a JSON object\nlet loginData = {\n    \"username\": username,\n    \"password\": password\n};\n\n// Set the payload to the formatted JSON\nmsg.payload = loginData;\n\n// Set headers (if needed, e.g., for content-type)\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\n// Return the message to pass it to the next node (e.g., HTTP request)\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":210,"y":320,"wires":[["64ed5dbf85e32ffc"]]},{"id":"73acfae14ccb6de6","type":"http request","z":"1602850f8ee96d62","name":"","method":"POST","ret":"txt","paytoqs":"ignore","url":"http://0.0.0.0:8080/register","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":510,"y":320,"wires":[["aa06cc31a1d1f870","874fdf7e7a24b3a4"]]},{"id":"64ed5dbf85e32ffc","type":"json","z":"1602850f8ee96d62","name":"","property":"payload","action":"","pretty":false,"x":350,"y":320,"wires":[["73acfae14ccb6de6"]]},{"id":"aa06cc31a1d1f870","type":"debug","z":"1602850f8ee96d62","name":"debug 20","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":680,"y":320,"wires":[]},{"id":"874fdf7e7a24b3a4","type":"json","z":"1602850f8ee96d62","name":"","property":"payload","action":"","pretty":false,"x":130,"y":420,"wires":[["28164e59571082f9"]]},{"id":"28164e59571082f9","type":"switch","z":"1602850f8ee96d62","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"success","vt":"str"},{"t":"eq","v":"error","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":270,"y":420,"wires":[["139c05062a15f548"],["604379b24787d50c"]]},{"id":"b46ff3b53b68ec72","type":"ui_ui_control","z":"1602850f8ee96d62","name":"Home","events":"all","x":710,"y":480,"wires":[[]]},{"id":"139c05062a15f548","type":"change","z":"1602850f8ee96d62","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Home\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":400,"wires":[["b46ff3b53b68ec72","47a896f01891360c","8b995562458d94c3"]]},{"id":"ea24bca859c26eca","type":"ui_button","z":"1602850f8ee96d62","name":"Register","group":"a7513268b5069b0b","order":3,"width":0,"height":0,"passthru":false,"label":"Register","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":80,"y":660,"wires":[["76e9c181b911c678"]]},{"id":"76e9c181b911c678","type":"change","z":"1602850f8ee96d62","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Register\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":660,"wires":[["8f7ceb631146d260","0dfde4d70733bd7a"]]},{"id":"8f7ceb631146d260","type":"ui_ui_control","z":"1602850f8ee96d62","name":"to Register","events":"all","x":510,"y":660,"wires":[["c34476617c4cd2ca"]]},{"id":"c34476617c4cd2ca","type":"debug","z":"1602850f8ee96d62","name":"debug 23","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":800,"y":660,"wires":[]},{"id":"0dfde4d70733bd7a","type":"debug","z":"1602850f8ee96d62","name":"debug 24","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":500,"y":720,"wires":[]},{"id":"4e26250fd8b95029","type":"ui_text_input","z":"1602850f8ee96d62","name":"Name","label":"Name","tooltip":"","group":"339285a0c8df0979","order":1,"width":0,"height":0,"passthru":false,"mode":"text","delay":300,"topic":"topic","sendOnBlur":false,"className":"","topicType":"msg","x":70,"y":820,"wires":[["5c5190cf67838051","dd91862d76d56ecc"]]},{"id":"39b6c3a3c18d5739","type":"ui_text_input","z":"1602850f8ee96d62","name":"Username","label":"Username","tooltip":"","group":"339285a0c8df0979","order":2,"width":0,"height":0,"passthru":true,"mode":"text","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":90,"y":880,"wires":[["93eabe8ceb8e9630"]]},{"id":"6842756150f4560e","type":"ui_text_input","z":"1602850f8ee96d62","name":"Telegram User","label":"Telegram User","tooltip":"","group":"339285a0c8df0979","order":4,"width":0,"height":0,"passthru":true,"mode":"text","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":100,"y":940,"wires":[["02c60130d9830518"]]},{"id":"5d1214326c6e1199","type":"ui_text_input","z":"1602850f8ee96d62","name":"Password","label":"Password","tooltip":"","group":"339285a0c8df0979","order":5,"width":0,"height":0,"passthru":true,"mode":"password","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":80,"y":1000,"wires":[["2141ceefe49655ac"]]},{"id":"2a6e04e7b41bad8b","type":"ui_text_input","z":"1602850f8ee96d62","name":"","label":"Password confirmation","tooltip":"","group":"339285a0c8df0979","order":6,"width":0,"height":0,"passthru":true,"mode":"password","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":120,"y":1060,"wires":[["9f3d7f305388f3e7"]]},{"id":"5c5190cf67838051","type":"change","z":"1602850f8ee96d62","name":"","rules":[{"t":"move","p":"payload","pt":"msg","to":"inputName","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":350,"y":820,"wires":[["b60d4e6e5711f26c"]]},{"id":"93eabe8ceb8e9630","type":"change","z":"1602850f8ee96d62","name":"","rules":[{"t":"move","p":"payload","pt":"msg","to":"inputUsername","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":330,"y":880,"wires":[[]]},{"id":"02c60130d9830518","type":"change","z":"1602850f8ee96d62","name":"","rules":[{"t":"move","p":"payload","pt":"msg","to":"telegramUser","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":330,"y":940,"wires":[[]]},{"id":"2141ceefe49655ac","type":"change","z":"1602850f8ee96d62","name":"","rules":[{"t":"move","p":"payload","pt":"msg","to":"inputPassword","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":310,"y":1000,"wires":[[]]},{"id":"9f3d7f305388f3e7","type":"change","z":"1602850f8ee96d62","name":"","rules":[{"t":"move","p":"payload","pt":"msg","to":"confirmPassword","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":330,"y":1060,"wires":[[]]},{"id":"789e9fefa2fab342","type":"switch","z":"1602850f8ee96d62","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"error","vt":"str"},{"t":"eq","v":"success","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":410,"y":1240,"wires":[["03b00afa3098f92d"],["44f4ba1d54609482"]]},{"id":"fb3c4866ddcef910","type":"function","z":"1602850f8ee96d62","name":"function 21","func":"if(msg.payload != \"\")\n    flow.set(\"nameInput\",msg.payload);\nelse\n    msg.payload=\"Empty\"    \nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":190,"y":720,"wires":[[]]},{"id":"ba3a6b9df7cba958","type":"switch","z":"1602850f8ee96d62","name":"","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"","vt":"str"},{"t":"eq","v":"","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":960,"wires":[[],[]]},{"id":"03b00afa3098f92d","type":"ui_toast","z":"1602850f8ee96d62","position":"top right","displayTime":"3","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":true,"className":"","topic":"Empty Values","name":"Empty Value","x":630,"y":1120,"wires":[]},{"id":"f7766aa1b46aedc2","type":"ui_button","z":"1602850f8ee96d62","name":"","group":"339285a0c8df0979","order":7,"width":0,"height":0,"passthru":false,"label":"Submit","tooltip":"","color":"","bgcolor":"","className":"","icon":"submit","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":80,"y":1240,"wires":[["1891f7a394802944"]]},{"id":"1891f7a394802944","type":"function","z":"1602850f8ee96d62","name":"function 22","func":"\n// Retrieve the flow variables\nlet inputName = flow.get('inputName') ;\nlet inputPassword = flow.get('inputPassword');\nlet confirmPassword = flow.get('confirmPassword');\nlet telegramUser = flow.get('telegramUser');\nlet inputUsername = flow.get('inputUsername');\nlet email = flow.get('email');\n\n// Check if any field is empty and return an error message\nif (inputName === \"\") {\n    msg.payload = {status: \"error\", message: \"Name cannot be empty\"};\n    return msg;\n}\nif (inputUsername === \"\") {\n    msg.payload = {status: \"error\", message: \"Username cannot be empty\"};\n    return msg;\n}\nif (inputPassword === \"\") {\n    msg.payload = {status: \"error\", message: \"Password cannot be empty\"};\n    return msg;\n}\nif (confirmPassword === \"\") {\n    msg.payload = {status: \"error\", message: \"Confirm Password cannot be empty\"};\n    return msg;\n}\nif (telegramUser === \"\") {\n    msg.payload = {status: \"error\", message: \"Telegram User cannot be empty\"};\n    return msg;\n}\nif (email === \"\") {\n    msg.payload = {status: \"error\", message: \"Email cannot be empty\"};\n    return msg;\n}\n\n// If all fields are filled, return a success message\nmsg.payload = {status: \"success\", message: \"All fields are filled in correctly\"};\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":250,"y":1240,"wires":[["789e9fefa2fab342","01481129c078758c"]]},{"id":"44f4ba1d54609482","type":"function","z":"1602850f8ee96d62","name":"function 23","func":"// Access the values from flow variables\nlet inputPassword = flow.get(\"inputPassword\");\nlet confirmPassword = flow.get(\"confirmPassword\");\n\n// Create the response object\nlet response = {};\n\nif (inputPassword === confirmPassword) {\n    response = {\n        \"status\": \"success\",\n        \"message\": \"Username matches the confirm password\"\n    };\n} else {\n    response = {\n        \"status\": \"error\",\n        \"message\": \"Username does not match the confirm password\"\n    };\n}\n\n// Set the message payload to the response object\nmsg.payload = response;\n\n// Return the message\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":330,"y":1340,"wires":[["ba062538dea27bb2"]]},{"id":"da29f9e8e9b9e23d","type":"ui_toast","z":"1602850f8ee96d62","position":"top right","displayTime":"3","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":true,"className":"","topic":"Passwords does not match","name":"Password different","x":710,"y":1260,"wires":[]},{"id":"c62b43c58241a56c","type":"debug","z":"1602850f8ee96d62","name":"debug 25","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":780,"y":1600,"wires":[]},{"id":"01481129c078758c","type":"debug","z":"1602850f8ee96d62","name":"debug 26","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":420,"y":1180,"wires":[]},{"id":"c988a2243fdf979d","type":"function","z":"1602850f8ee96d62","name":"function 24","func":"// Access the values from flow variables\nlet inputName = flow.get(\"inputName\");\nlet inputPassword = flow.get(\"inputPassword\");\nlet confirmPassword = flow.get(\"confirmPassword\");\nlet telegramUser = flow.get(\"telegramUser\");\nlet inputUsername = flow.get(\"inputUsername\");\nlet email = flow.get('email');\n\n// Create the JSON object with all variables\nlet jsonResponse = {\n    \"inputName\": inputName ,\n    \"inputPassword\": inputPassword,\n    \"confirmPassword\": confirmPassword ,\n    \"telegramUser\": telegramUser ,\n    \"inputUsername\": inputUsername,\n    \"email\": email\n};\n\n// Set the message payload to the JSON object\nmsg.payload = jsonResponse;\n\n// Return the message\nreturn msg;\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":390,"y":1460,"wires":[["ed8d117180890e39"]]},{"id":"ba062538dea27bb2","type":"switch","z":"1602850f8ee96d62","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"error","vt":"str"},{"t":"eq","v":"success","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":490,"y":1340,"wires":[["da29f9e8e9b9e23d"],["c988a2243fdf979d"]]},{"id":"dd91862d76d56ecc","type":"debug","z":"1602850f8ee96d62","name":"debug 27","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":260,"y":780,"wires":[]},{"id":"b60d4e6e5711f26c","type":"debug","z":"1602850f8ee96d62","name":"debug 28","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":580,"y":820,"wires":[]},{"id":"002b1cd5caa506e1","type":"http request","z":"1602850f8ee96d62","name":"","method":"PUT","ret":"txt","paytoqs":"ignore","url":"http://0.0.0.0:8080/register","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":710,"y":1460,"wires":[["c62b43c58241a56c"]]},{"id":"ed8d117180890e39","type":"json","z":"1602850f8ee96d62","name":"","property":"payload","action":"","pretty":false,"x":550,"y":1460,"wires":[["002b1cd5caa506e1","4612cb7065b2d2d1"]]},{"id":"4612cb7065b2d2d1","type":"debug","z":"1602850f8ee96d62","name":"debug 29","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":600,"y":1600,"wires":[]},{"id":"1dca9b80e26456f8","type":"ui_text_input","z":"1602850f8ee96d62","name":"Email","label":"email","tooltip":"","group":"339285a0c8df0979","order":3,"width":0,"height":0,"passthru":true,"mode":"email","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":70,"y":1120,"wires":[["0358497b031c6243"]]},{"id":"0358497b031c6243","type":"change","z":"1602850f8ee96d62","name":"","rules":[{"t":"move","p":"payload","pt":"msg","to":"email","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":270,"y":1120,"wires":[[]]},{"id":"a52b536f8731e71b","type":"function","z":"1602850f8ee96d62","name":"function 25","func":"msg.payload = {\n    \"tabs\": {\n        \"hide\": [\"Lamp Control\", \"Home\", \"Historical Data\", \"Register\", \"Air Control\", \"Alarms\"]\n    }\n};\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":250,"y":40,"wires":[["1b824e2b4371fad1"]]},{"id":"1b824e2b4371fad1","type":"ui_ui_control","z":"1602850f8ee96d62","name":"","events":"all","x":420,"y":40,"wires":[[]]},{"id":"fb79f8754eb2b4c9","type":"inject","z":"1602850f8ee96d62","name":"","props":[{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/1 0 * * *","once":true,"onceDelay":"0.8","topic":"","x":90,"y":40,"wires":[["a52b536f8731e71b"]]},{"id":"47a896f01891360c","type":"ui_toast","z":"1602850f8ee96d62","position":"top right","displayTime":"3","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":true,"className":"","topic":"Acess confimed","name":"","x":650,"y":560,"wires":[]},{"id":"604379b24787d50c","type":"ui_toast","z":"1602850f8ee96d62","position":"top right","displayTime":"3","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":true,"className":"","topic":"Invalid Username or Password","name":"","x":350,"y":520,"wires":[]},{"id":"6e8c5fc8b0d62b8c","type":"ui_ui_control","z":"1602850f8ee96d62","name":"","events":"all","x":880,"y":400,"wires":[[]]},{"id":"8b995562458d94c3","type":"function","z":"1602850f8ee96d62","name":"function 27","func":"msg.payload = {\n    \"tabs\": {\n        \"hide\": [\"Log in\"],  // Hide only the \"Log in\" tab\n        \"show\": [\"Lamp Control\", \"Home\", \"Historical Data\", \"Register\", \"Air Control\", \"Alarms\"]  // Unhide the other tabs\n    }\n};\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":690,"y":400,"wires":[["6e8c5fc8b0d62b8c"]]},{"id":"a7513268b5069b0b","type":"ui_group","name":"Log in","tab":"4a189ca57dad7ce7","order":1,"disp":false,"width":"6","collapse":false,"className":""},{"id":"339285a0c8df0979","type":"ui_group","name":"Register","tab":"0d41725f52cd45dc","order":1,"disp":true,"width":"6","collapse":false,"className":""},{"id":"4a189ca57dad7ce7","type":"ui_tab","name":"log in","icon":"dashboard","order":1,"disabled":false,"hidden":false},{"id":"0d41725f52cd45dc","type":"ui_tab","name":"Register","icon":"dashboard","order":5,"disabled":false,"hidden":false}]
