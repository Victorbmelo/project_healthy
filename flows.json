[{"id":"1d28ab40a18bec3b","type":"tab","label":"Flow 2","disabled":false,"info":"","env":[]},{"id":"fe357fd7a35d0ff3","type":"debug","z":"1d28ab40a18bec3b","name":"debug 1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":780,"y":580,"wires":[]},{"id":"eb68d9e735036d6a","type":"debug","z":"1d28ab40a18bec3b","name":"debug 2","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":580,"y":120,"wires":[]},{"id":"de8365a5d3e94122","type":"debug","z":"1d28ab40a18bec3b","name":"debug 3","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":560,"y":240,"wires":[]},{"id":"3bc84a5217ceac90","type":"debug","z":"1d28ab40a18bec3b","name":"debug 4","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":560,"y":320,"wires":[]},{"id":"f1dd8c9f78e66091","type":"function","z":"1d28ab40a18bec3b","name":"function 2","func":"function convertMillisecondsToTime(millis) {\n    let date = new Date(millis);\n    let hours = date.getUTCHours().toString().padStart(2, '0');\n    let minutes = date.getUTCMinutes().toString().padStart(2, '0');\n    let seconds = date.getUTCSeconds().toString().padStart(2, '0');\n    return `${hours}:${minutes}:${seconds}`;\n}\n\nvar dict=flow.get(\"obj\")||{\"time\" :\"00:00\",\n    \"weekdays\": [],   \n    \"state\": \"\"}\n\nmsg.payload = convertMillisecondsToTime(msg.payload);\n\ndict.time =msg.payload\nflow.set(\"obj\", dict)\nmsg.payload= dict\n\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":160,"wires":[["eb68d9e735036d6a"]]},{"id":"13e8ef15c626ac8f","type":"function","z":"1d28ab40a18bec3b","name":"function 4","func":"var dict=flow.get(\"obj\")||{\"time\" : \"00:00\",\n    \"weekdays\": [],   \n    \"state\": \"\" }\n\ndict.weekdays =msg.payload\nflow.set(\"obj\", dict)\nmsg.payload = dict\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":220,"wires":[["de8365a5d3e94122"]]},{"id":"3cdc9bb4caca8aca","type":"function","z":"1d28ab40a18bec3b","name":"function 5","func":"\nvar dict=flow.get(\"obj\")||{\"time\" : \"00:00\",\n    \"weekdays\": [],   \n    \"state\": \"\" }\n\n//dict.state =dict.state.toLowerCase()\ndict.state =msg.payload\nflow.set(\"obj\", dict)\nmsg.payload= dict\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":320,"wires":[["3bc84a5217ceac90"]]},{"id":"f238a067a40dcad2","type":"debug","z":"1d28ab40a18bec3b","name":"debug 5","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":780,"y":180,"wires":[]},{"id":"61269081c57d643f","type":"http request","z":"1d28ab40a18bec3b","name":"","method":"PUT","ret":"txt","paytoqs":"ignore","url":"http://0.0.0.0:8080/test","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Content-Type","keyValue":"","valueType":"application/json","valueValue":""}],"x":410,"y":440,"wires":[["1f2c9ce26d6f2864","099645a762f32b46","d13c3fadc73ae48b"]]},{"id":"1f2c9ce26d6f2864","type":"debug","z":"1d28ab40a18bec3b","name":"debug 7","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":680,"y":380,"wires":[]},{"id":"1bd6448aa2652cb5","type":"ui_table","z":"1d28ab40a18bec3b","group":"d0ce65ddaf752a43","name":"","order":7,"width":0,"height":0,"columns":[{"field":"id","title":"Id","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"weekdays","title":"weekdays","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"time","title":"time","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"state","title":"Action","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}}],"outputs":1,"cts":true,"x":490,"y":640,"wires":[["fe357fd7a35d0ff3","3d812743de72a8e1","caedf4cd960bdca4"]]},{"id":"3623b3e5402c5b22","type":"ui_text_input","z":"1d28ab40a18bec3b","name":"Select Time","label":"Select TIme","tooltip":"","group":"d0ce65ddaf752a43","order":3,"width":0,"height":0,"passthru":false,"mode":"time","delay":300,"topic":"payload","sendOnBlur":false,"className":"","topicType":"msg","x":110,"y":160,"wires":[["f1dd8c9f78e66091"]]},{"id":"9edb75148cdca716","type":"ui_dropdown","z":"1d28ab40a18bec3b","name":"","label":"Select Weekdays","tooltip":"","place":"Select Weekdays","group":"d0ce65ddaf752a43","order":2,"width":0,"height":0,"passthru":true,"multiple":true,"options":[{"label":"","value":"Sunday","type":"str"},{"label":"","value":"Monday","type":"str"},{"label":"","value":"Tuesday","type":"str"},{"label":"","value":"Wednesday","type":"str"},{"label":"","value":"Thursday","type":"str"},{"label":"","value":"Friday","type":"str"},{"label":"","value":"Saturday","type":"str"}],"payload":"","topic":"topic","topicType":"msg","className":"","x":130,"y":220,"wires":[["13e8ef15c626ac8f"]]},{"id":"1f40804e41e2ea59","type":"ui_dropdown","z":"1d28ab40a18bec3b","name":"","label":"Action","tooltip":"","place":"State","group":"d0ce65ddaf752a43","order":4,"width":0,"height":0,"passthru":true,"multiple":false,"options":[{"label":" Turn On","value":true,"type":"bool"},{"label":"Turn Off","value":false,"type":"bool"}],"payload":"","topic":"topic","topicType":"msg","className":"","x":90,"y":320,"wires":[["3cdc9bb4caca8aca"]]},{"id":"099645a762f32b46","type":"ui_toast","z":"1d28ab40a18bec3b","position":"dialog","displayTime":"3","highlight":"","sendall":true,"outputs":1,"ok":"OK","cancel":"","raw":false,"className":"","topic":"msg.payload","name":"","x":690,"y":460,"wires":[[]]},{"id":"2ea2a9f57cac8678","type":"json","z":"1d28ab40a18bec3b","name":"","property":"payload","action":"","pretty":true,"x":230,"y":440,"wires":[["61269081c57d643f"]]},{"id":"94f6d08eccf9c862","type":"ui_button","z":"1d28ab40a18bec3b","name":"","group":"d0ce65ddaf752a43","order":5,"width":0,"height":0,"passthru":false,"label":"Add Row","tooltip":"","color":"","bgcolor":"green","className":"","icon":"fa-plus-squared","payload":"obj","payloadType":"flow","topic":"topic","topicType":"msg","x":80,"y":440,"wires":[["2ea2a9f57cac8678"]]},{"id":"1117876611a416aa","type":"debug","z":"1d28ab40a18bec3b","name":"debug 10","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":300,"y":660,"wires":[]},{"id":"d13c3fadc73ae48b","type":"http request","z":"1d28ab40a18bec3b","name":"","method":"GET","ret":"obj","paytoqs":"ignore","url":"http://0.0.0.0:8080/test","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Content-Type","keyValue":"","valueType":"application/json","valueValue":""}],"x":270,"y":600,"wires":[["1117876611a416aa","1bd6448aa2652cb5"]]},{"id":"bc5cc9a462bceb38","type":"ui_button","z":"1d28ab40a18bec3b","name":"","group":"d0ce65ddaf752a43","order":8,"width":0,"height":0,"passthru":false,"label":"Delete","tooltip":"","color":"","bgcolor":"red","className":"","icon":"fa-trash","payload":"line_selected","payloadType":"flow","topic":"payload","topicType":"msg","x":50,"y":1080,"wires":[["0b793fae5e1cd024"]]},{"id":"eef526c152ee6c2d","type":"debug","z":"1d28ab40a18bec3b","name":"debug 11","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":680,"y":820,"wires":[]},{"id":"6740333f14b47192","type":"ui_button","z":"1d28ab40a18bec3b","name":"","group":"d0ce65ddaf752a43","order":12,"width":0,"height":0,"passthru":false,"label":"Update ","tooltip":"","color":"","bgcolor":"","className":"","icon":"update","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":80,"y":600,"wires":[["d13c3fadc73ae48b"]]},{"id":"c2eb5adbe54cccf9","type":"function","z":"1d28ab40a18bec3b","name":"function 10","func":"// Modify the state of each item in the payload\nmsg.payload = msg.payload.map(item => {\n    // Check if the state is \"0\" or \"1\" and change it accordingly\n    item.state = item.state === \"0\" ? \"Turn off\" : \"Turn on\";\n    return item;\n});\n\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":580,"wires":[[]]},{"id":"ec8a42057c0d79fc","type":"http request","z":"1d28ab40a18bec3b","name":"","method":"DELETE","ret":"obj","paytoqs":"body","url":"","tls":"","persist":false,"proxy":"","insecureHTTPParser":true,"authType":"","senderr":false,"headers":[],"x":790,"y":1160,"wires":[["94f24be1463e8361","b301f3ccf22df2b1"]]},{"id":"94f24be1463e8361","type":"debug","z":"1d28ab40a18bec3b","name":"debug 12","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":920,"y":1000,"wires":[]},{"id":"3d812743de72a8e1","type":"function","z":"1d28ab40a18bec3b","name":"function 12","func":"// Store msg.payload into flow variable 'line_selected'\nflow.set('line_selected', msg.payload);\n\n// Return msg for further processing if needed\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":680,"wires":[[]]},{"id":"a4e0e680e12ddcfe","type":"function","z":"1d28ab40a18bec3b","name":"function 13","func":"msg.url = `http://localhost:8080/test/?id=${msg.payload.id}`; // Dynamically set the URL\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":590,"y":1180,"wires":[["ec8a42057c0d79fc"]]},{"id":"8cddeb79b348c0a5","type":"ui_template","z":"1d28ab40a18bec3b","group":"d0ce65ddaf752a43","name":"","order":9,"width":0,"height":0,"format":"<script>\n(function(scope) {\n    scope.$watch('msg', function(msg) {\n        if (msg && msg.payload) {\n            var selectedRowId = msg.payload.id;\n\n            // Clear previously highlighted rows\n            var tableRows = document.querySelectorAll(\".tabulator-row\");\n            tableRows.forEach(row => {\n                row.style.backgroundColor = \"\";\n            });\n\n            // Highlight the selected row based on ID\n            var selectedRow = Array.from(tableRows).find(row => {\n                return row.querySelector(\".tabulator-cell[tabulator-field='id']\").innerText.trim() === String(selectedRowId);\n            });\n\n            if (selectedRow) {\n                selectedRow.style.backgroundColor = \"#98fb98\";\n            }\n        }\n    });\n})(scope);\n</script>\n\n<style>\n/* Optional: Add any custom styling for the table */\n.tabulator-row {\n    transition: background-color 0.3s ease;\n}\n</style>\n","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":700,"y":740,"wires":[[]]},{"id":"caedf4cd960bdca4","type":"function","z":"1d28ab40a18bec3b","name":"function 14","func":"// Store the selected row ID in a flow variable\nflow.set('selectedRowId', msg.payload.id);\n\n// Pass the message along\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":740,"wires":[["eef526c152ee6c2d","8cddeb79b348c0a5"]]},{"id":"0b793fae5e1cd024","type":"ui_toast","z":"1d28ab40a18bec3b","position":"dialog","displayTime":"3","highlight":"","sendall":true,"outputs":1,"ok":"Yes, Delete it","cancel":"Cancel","raw":false,"className":"msg.payload","topic":"Do you want to delete it?","name":"","x":190,"y":1080,"wires":[["57c08801ee46964d","adb422fb3073973f"]]},{"id":"57c08801ee46964d","type":"debug","z":"1d28ab40a18bec3b","name":"debug 13","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":420,"y":1260,"wires":[]},{"id":"adb422fb3073973f","type":"switch","z":"1d28ab40a18bec3b","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"Yes, Delete it","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":350,"y":1080,"wires":[["a083d5fb7438a4a3"]]},{"id":"a083d5fb7438a4a3","type":"change","z":"1d28ab40a18bec3b","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"line_selected","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":1080,"wires":[["a4e0e680e12ddcfe"]]},{"id":"8684a73caa8176d0","type":"link in","z":"1d28ab40a18bec3b","name":"link in 3","links":["b301f3ccf22df2b1"],"x":115,"y":720,"wires":[["d13c3fadc73ae48b"]]},{"id":"b301f3ccf22df2b1","type":"link out","z":"1d28ab40a18bec3b","name":"link out 1","mode":"link","links":["8684a73caa8176d0"],"x":755,"y":920,"wires":[]},{"id":"9103cc0b20a6c61a","type":"ui_spacer","z":"1d28ab40a18bec3b","name":"spacer","group":"d0ce65ddaf752a43","order":1,"width":8,"height":1},{"id":"64a675367b034ed7","type":"ui_spacer","z":"1d28ab40a18bec3b","name":"spacer","group":"d0ce65ddaf752a43","order":6,"width":8,"height":1},{"id":"d0ce65ddaf752a43","type":"ui_group","name":"Health System","tab":"b02562d37cc13e0d","order":1,"disp":true,"width":"8","collapse":false,"className":""},{"id":"b02562d37cc13e0d","type":"ui_tab","name":"Home","icon":"dashboard","disabled":false,"hidden":false}]
